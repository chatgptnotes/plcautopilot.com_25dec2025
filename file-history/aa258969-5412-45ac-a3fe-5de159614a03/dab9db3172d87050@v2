# Supabase Bucket Setup Guide (Hindi)
## NeuroSense Reports рдХреЗ рд▓рд┐рдП Cloud Storage

рдпрд╣ guide рдЖрдкрдХреЛ NeuroSense PDF reports рдХреЛ Supabase cloud storage рдореЗрдВ store рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП bucket рдмрдирд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧреАред

---

## ЁЯУЛ рдЬрд░реВрд░реА рдЪреАрдЬреЗрдВ

рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕:
- тЬЕ Supabase account рд╣реИ (https://supabase.com)
- тЬЕ NeuroSense project Supabase рдореЗрдВ рдмрдирд╛ рд╣реБрдЖ рд╣реИ
- тЬЕ рдЖрдкрдХреА `.env` file рдореЗрдВ Supabase credentials рд╣реИрдВ:
  ```env
  SUPABASE_URL=https://your-project.supabase.co
  SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
  ```

---

## ЁЯЪА рддрд░реАрдХрд╛ 1: Automatic Setup (Node.js Script рд╕реЗ) - рд╕рдмрд╕реЗ рдЖрд╕рд╛рди!

### Step 1: Terminal рдЦреЛрд▓реЗрдВ

рдЕрдкрдиреЗ project рдХреЗ root folder рдореЗрдВ terminal рдЦреЛрд▓реЗрдВред

### Step 2: .env File Check рдХрд░реЗрдВ

рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреА `.env` file рдореЗрдВ рдпреЗ credentials рд╣реИрдВ:
```env
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
```

**Credentials рдХрд╣рд╛рдБ рд╕реЗ рд▓реЗрдВ:**
1. Supabase Dashboard рдЦреЛрд▓реЗрдВ: https://supabase.com/dashboard
2. рдЕрдкрдирд╛ project select рдХрд░реЗрдВ
3. рдЬрд╛рдПрдВ: **Project Settings тЖТ API**
4. Copy рдХрд░реЗрдВ:
   - **SUPABASE_URL**: "Project URL" рд╕реЗ
   - **SUPABASE_SERVICE_ROLE_KEY**: "service_role" key рд╕реЗ (secret key)

### Step 3: Script Run рдХрд░реЗрдВ

Terminal рдореЗрдВ рдпрд╣ command рдЪрд▓рд╛рдПрдВ:

```bash
node server/scripts/createNeuroSenseBucket.js
```

### Step 4: Output рджреЗрдЦреЗрдВ

рдЖрдкрдХреЛ рдпрд╣ рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:

```
ЁЯЪА ===== Creating NeuroSense Reports Bucket =====

ЁЯФН Checking if bucket already exists...
ЁЯУж Creating bucket...
тЬЕ Bucket created successfully!
   Bucket name: neurosense-reports
   Public: Yes
   File size limit: 50 MB
   Allowed types: PDF only

ЁЯФТ Setting up security policies...
   тЬЕ INSERT policy created
   тЬЕ SELECT policy created
   тЬЕ UPDATE policy created
   тЬЕ DELETE policy created

тЬЕ ===== Bucket Setup Complete! =====

ЁЯОЙ Your NeuroSense reports will now be stored in the cloud!
```

### Step 5: Verify рдХрд░реЗрдВ Supabase Dashboard рдореЗрдВ

1. Supabase Dashboard рдЦреЛрд▓реЗрдВ
2. Left sidebar рдореЗрдВ **Storage** рдкрд░ click рдХрд░реЗрдВ
3. рдЖрдкрдХреЛ **neurosense-reports** bucket рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП тЬЕ

рд╣реЛ рдЧрдпрд╛! ЁЯОЙ

---

## ЁЯЫая╕П рддрд░реАрдХрд╛ 2: Manual Setup (UI рд╕реЗ)

рдЕрдЧрд░ рдЖрдк script рд╕реЗ bucket рдирд╣реАрдВ рдмрдирд╛ рдкрд╛ рд░рд╣реЗ рд╣реИрдВ, рддреЛ manually рдмрдирд╛рдПрдВ:

### Step 1: Supabase Dashboard рдореЗрдВ рдЬрд╛рдПрдВ

1. https://supabase.com/dashboard рдЦреЛрд▓реЗрдВ
2. рдЕрдкрдирд╛ NeuroSense project select рдХрд░реЗрдВ
3. Left sidebar рдореЗрдВ **Storage** рдкрд░ click рдХрд░реЗрдВ

### Step 2: New Bucket рдмрдирд╛рдПрдВ

1. **"New bucket"** button рдкрд░ click рдХрд░реЗрдВ
2. рдпреЗ details рднрд░реЗрдВ:
   - **Bucket name**: `neurosense-reports` (exactly рдпрд╣реА name)
   - **Public bucket**: тЬЕ Check рдХрд░реЗрдВ (Yes)
   - **File size limit**: `50 MB`
   - **Allowed MIME types**: `application/pdf`
3. **"Create bucket"** рдкрд░ click рдХрд░реЗрдВ

### Step 3: Policies Setup рдХрд░реЗрдВ

1. **neurosense-reports** bucket рдкрд░ click рдХрд░реЗрдВ
2. **"Policies"** tab рдЦреЛрд▓реЗрдВ
3. рдиреАрдЪреЗ рджрд┐рдП рдЧрдП policies add рдХрд░реЗрдВ:

#### Policy 1: Upload рдХреА рдЕрдиреБрдорддрд┐ (INSERT)
- **Policy name**: Allow authenticated users to upload PDFs
- **Target roles**: `authenticated`
- **Operation**: `INSERT`
- **Policy definition**:
  ```sql
  bucket_id = 'neurosense-reports' AND
  (storage.extension(name) = 'pdf')
  ```

#### Policy 2: Download рдХреА рдЕрдиреБрдорддрд┐ (SELECT)
- **Policy name**: Allow public read access to PDFs
- **Target roles**: `public`
- **Operation**: `SELECT`
- **Policy definition**:
  ```sql
  bucket_id = 'neurosense-reports'
  ```

#### Policy 3: Update рдХреА рдЕрдиреБрдорддрд┐ (UPDATE)
- **Policy name**: Allow authenticated users to update PDFs
- **Target roles**: `authenticated`
- **Operation**: `UPDATE`
- **Policy definition**:
  ```sql
  bucket_id = 'neurosense-reports'
  ```

#### Policy 4: Delete рдХреА рдЕрдиреБрдорддрд┐ (DELETE)
- **Policy name**: Allow authenticated users to delete PDFs
- **Target roles**: `authenticated`
- **Operation**: `DELETE`
- **Policy definition**:
  ```sql
  bucket_id = 'neurosense-reports'
  ```

рд╣реЛ рдЧрдпрд╛! ЁЯОЙ

---

## тЬЕ Test рдХрд░реЗрдВ

### Step 1: Backend Server Start рдХрд░реЗрдВ

```bash
npm run dev:backend
```

### Step 2: Logs Check рдХрд░реЗрдВ

Backend logs рдореЗрдВ рдпрд╣ рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:
```
тЬЕ Supabase credentials found
   SUPABASE_URL: Set
   SUPABASE_SERVICE_ROLE_KEY: Set
```

### Step 3: Report Generate рдХрд░реЗрдВ

1. Algorithm Processor page рдЦреЛрд▓реЗрдВ
2. QEEG files upload рдХрд░реЗрдВ
3. "Execute Calculation" click рдХрд░реЗрдВ
4. **"Save & Download NeuroSense Report"** button click рдХрд░реЗрдВ

### Step 4: Backend Logs рджреЗрдЦреЗрдВ

рдЖрдкрдХреЛ рдпрд╣ рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:
```
тШБя╕П  Uploading PDF to Supabase storage...
тЬЕ PDF uploaded to Supabase successfully
ЁЯФЧ Supabase URL: https://...pdf
```

### Step 5: Supabase рдореЗрдВ Verify рдХрд░реЗрдВ

1. Supabase Dashboard тЖТ **Storage** тЖТ **neurosense-reports** тЖТ **reports/**
2. рдЖрдкрдХреЛ PDF file рджрд┐рдЦрдиреА рдЪрд╛рд╣рд┐рдП! ЁЯОЙ

---

## ЁЯУВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ

рдЬрдм user **"Save & Download NeuroSense Report"** click рдХрд░рддрд╛ рд╣реИ:

1. тЬЕ **AI рд╕реЗ PDF generate рд╣реЛрддрд╛ рд╣реИ** (Gemini AI рд╕реЗ)
2. тЬЕ **Local folder рдореЗрдВ temporarily save рд╣реЛрддрд╛ рд╣реИ**
3. тЬЕ **Supabase cloud рдореЗрдВ upload рд╣реЛрддрд╛ рд╣реИ** (`neurosense-reports/reports/`)
4. тЬЕ **Local file delete рд╣реЛ рдЬрд╛рддреА рд╣реИ** (server space рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП)
5. тЬЕ **Supabase URL database рдореЗрдВ save рд╣реЛрддрд╛ рд╣реИ**
6. тЬЕ **User рдХреЗ рд▓рд┐рдП PDF automatically download рд╣реЛрддрд╛ рд╣реИ**
7. тЬЕ **Processing History рдореЗрдВ рджрд┐рдЦрддрд╛ рд╣реИ** cloud download link рдХреЗ рд╕рд╛рде

**Safe Fallback:** рдЕрдЧрд░ Supabase upload fail рд╣реЛ рдЬрд╛рдП, рддреЛ local file рд░рд╣реЗрдЧреА рдФрд░ local URL use рд╣реЛрдЧрд╛ред рджреЛрдиреЛрдВ рддрд░реАрдХреЗ рд╕реЗ PDF accessible рд░рд╣реЗрдЧрд╛!

---

## ЁЯФЧ PDF Links

рдЖрдкрдХреЗ PDFs рдЗрд╕ рддрд░рд╣ рдХреЗ URLs рдкрд░ accessible рд╣реЛрдВрдЧреЗ:

```
https://your-project.supabase.co/storage/v1/object/public/neurosense-reports/reports/neurosense-report-priyanka_sahare-1765341955844.pdf
```

---

## ЁЯОБ рдлрд╛рдпрджреЗ

тЬЕ **Cloud Storage** - PDFs Supabase cloud рдореЗрдВ store рд╣реЛрддреЗ рд╣реИрдВ, server рдкрд░ рдирд╣реАрдВ
тЬЕ **рдХреЛрдИ Limit рдирд╣реАрдВ** - Disk space рдХреА рдЪрд┐рдВрддрд╛ рдирд╣реАрдВ
тЬЕ **Fast Downloads** - Globally рддреЗрдЬрд╝ downloads
тЬЕ **Automatic Backups** - Supabase рдореЗрдВ built-in
тЬЕ **Public URLs** - рдЖрд╕рд╛рдиреА рд╕реЗ share рдФрд░ download
тЬЕ **Free Tier** - 1GB storage free рдореЗрдВ рдорд┐рд▓рддрд╛ рд╣реИ

---

## ЁЯРЫ Problems рдФрд░ Solutions

### Problem 1: Credentials рдирд╣реАрдВ рдорд┐рд▓ рд░рд╣реЗ

**Error:**
```
тЭМ Error: Supabase credentials not found!
```

**Solution:**
1. `.env` file check рдХрд░реЗрдВ - `SUPABASE_URL` рдФрд░ `SUPABASE_SERVICE_ROLE_KEY` рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП
2. Backend server restart рдХрд░реЗрдВ
3. `.env` file root folder рдореЗрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП (server/ folder рдореЗрдВ рдирд╣реАрдВ)

### Problem 2: Bucket рдирд╣реАрдВ рдмрдирд╛

**Error:**
```
Failed to create bucket
```

**Solution:**
1. Service role key рд╕рд╣реА рд╣реИ verify рдХрд░реЗрдВ
2. Supabase Dashboard рдореЗрдВ manually bucket рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ
3. Internet connection check рдХрд░реЗрдВ

### Problem 3: Upload Fail рд╣реЛ рд░рд╣рд╛ рд╣реИ

**Error:**
```
тЪая╕П Supabase upload failed, using local storage
```

**рдпрд╣ OK рд╣реИ!** System automatically local storage use рдХрд░ рд▓реЗрдЧрд╛ред Supabase рд╕рд┐рд░реНрдл prefer рд╣реЛрддрд╛ рд╣реИ, рдЬрд░реВрд░реА рдирд╣реАрдВред

---

## ЁЯУЮ рдорджрдж рдЪрд╛рд╣рд┐рдП?

рдЕрдЧрд░ рдХреЛрдИ problem рд╣реЛ рддреЛ:

1. **Backend logs check рдХрд░реЗрдВ** error messages рдХреЗ рд▓рд┐рдП
2. **Bucket exists verify рдХрд░реЗрдВ** Supabase Dashboard рдореЗрдВ
3. **Credentials verify рдХрд░реЗрдВ** Supabase тЖТ Project Settings тЖТ API
4. **Policies check рдХрд░реЗрдВ** Storage тЖТ neurosense-reports тЖТ Policies

---

## тЬи рд╣реЛ рдЧрдпрд╛!

рдЖрдкрдХреЗ NeuroSense reports рдЕрдм cloud рдореЗрдВ store рд╣реЛрдВрдЧреЗ! ЁЯОЙ

рд╣рд░ рдмрд╛рд░ рдЬрдм user report generate рдХрд░реЗрдЧрд╛:
- тЬЕ Professional PDF рдмрдиреЗрдЧрд╛ AI insights рдХреЗ рд╕рд╛рде
- тЬЕ Supabase cloud рдореЗрдВ upload рд╣реЛрдЧрд╛
- тЬЕ Database рдореЗрдВ URL save рд╣реЛрдЧрд╛
- тЬЕ User рдХреЗ рд▓рд┐рдП auto-download рд╣реЛрдЧрд╛
- тЬЕ Processing History рдореЗрдВ available рд╣реЛрдЧрд╛

Enjoy your cloud-powered NeuroSense system! ЁЯзатШБя╕П
